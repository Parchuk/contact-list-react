"use strict";var __awaiter=this&&this.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};Object.defineProperty(exports,"__esModule",{value:true});class Houk{constructor(){this.listeners=new Map}on(event,fn){const listeners=this.getListeners(event);listeners.add(fn);this.listeners.set(event,listeners)}off(event,fn){const listeners=this.getListeners(event);return listeners.delete(fn)}emit(event,thisArg,...args){return __awaiter(this,void 0,void 0,function*(){const listeners=this.getListeners(event);if(listeners.size===0){return args.length===1?args[0]:args}let result=args;for(const listener of listeners.values()){const array=toArray(result);result=(yield Promise.resolve(listener.apply(thisArg,array)))||result}return result})}getListeners(event){return this.listeners.get(event)||new Set}}exports.default=Houk;function toArray(input){return Array.isArray(input)?input:[input]}class HoukBus extends Houk{constructor(){super(...arguments);this.emit=super.emit;this.getListeners=super.getListeners}}exports.HoukBus=HoukBus;if(typeof module!=="undefined"){module.exports=Houk;module.exports.default=Houk;module.exports.Houk=Houk;module.exports.HoukBus=HoukBus}